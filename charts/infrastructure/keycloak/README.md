# Keycloak

Keycloak Identity and Access Management using the official Keycloak Operator.

## Prerequisites

- Postgres Operator installed
- Keycloak Database deployed

## Installation

```bash
./scripts/deploy-gke.sh keycloak
```

## Access

After deployment, access Keycloak at:
- **URL:** `https://keycloak.35.206.88.67.nip.io`
- **Admin User:** `admin`
- **Admin Password:** Set during deployment

## Architecture

This chart uses the official Keycloak Operator which:
- Manages Keycloak instances via CRDs
- Handles rolling updates
- Configures database connections
- Manages Ingress automatically (using `nginx` class)

## Configuration

### Admin Password

Set via environment variable:

```bash
export KEYCLOAK_ADMIN_PASSWORD="your-secure-password"
./scripts/deploy-gke.sh keycloak
```

### Database

Automatically connects to PostgreSQL database created by `keycloak-db` chart using the secret generated by Postgres Operator.

## Verification

```bash
# Check operator
kubectl get pods -n keycloak -l app.kubernetes.io/name=keycloak-operator

# Check Keycloak instance
kubectl get keycloak -n keycloak

# Check pods
kubectl get pods -n keycloak -l app=keycloak

# Check ingress
kubectl get ingress -n keycloak
```

## ArgoCD Compatibility

Fully compatible with ArgoCD:
- Uses official Keycloak Operator (OCI registry)
- Declarative Keycloak CR
- External database via existing secret
- Automated Ingress management
